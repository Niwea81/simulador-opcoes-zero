<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Simulador Educacional de OpÃ§Ãµes</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: radial-gradient(circle, #020617, #000);
  color: #e5e7eb;
  margin: 0;
}
.container {
  max-width: 1050px;
  margin: 40px auto;
  background: #020617;
  padding: 30px;
  border-radius: 18px;
}
h1, h2 {
  text-align: center;
  color: #facc15;
}
label {
  margin-top: 14px;
  display: block;
  font-weight: bold;
}
input, select {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  border-radius: 6px;
  border: none;
}
.note, .alert {
  margin-top: 12px;
  padding: 12px;
  border-radius: 6px;
}
.note { background:#020024; border-left:4px solid #facc15; }
.alert { background:#1e293b; border-left:4px solid #ef4444; }
button {
  margin-top: 25px;
  width: 100%;
  padding: 16px;
  font-size: 18px;
  background: #2563eb;
  border-radius: 10px;
  border: none;
  color: white;
  cursor: pointer;
}
.section {
  margin-top: 30px;
  background: #020024;
  padding: 20px;
  border-radius: 14px;
}
canvas { width:100%; height:260px; }
.tag {
  display:inline-block;
  padding:6px 12px;
  border-radius:8px;
  font-weight:bold;
}
.green{background:#22c55e;color:#000}
.yellow{background:#facc15;color:#000}
.red{background:#ef4444;color:#fff}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ“Š Simulador Educacional de OpÃ§Ãµes</h1>

<label>Ativo</label>
<select id="ativo">
  <optgroup label="Ãndices / ETFs">
    <option>SPY</option>
    <option>SPX</option>
    <option>XSP</option>
    <option>QQQ</option>
  </optgroup>
  <optgroup label="7 MagnÃ­ficas">
    <option>AAPL</option><option>MSFT</option><option>AMZN</option>
    <option>NVDA</option><option>GOOGL</option><option>META</option><option>TSLA</option>
  </optgroup>
</select>

<label>PreÃ§o Atual</label>
<input id="S" type="number" value="100">

<label>Strike</label>
<input id="K" type="number" value="105">

<label>Dias atÃ© o Vencimento</label>
<input id="T" type="number" value="7">

<label>Volatilidade (%)</label>
<input id="vol" type="number" value="20">

<label>Estrutura da OperaÃ§Ã£o</label>
<select id="estrutura">
  <option value="call_buy">Call Comprada</option>
  <option value="put_buy">Put Comprada</option>
  <option value="call_sell">Call Vendida (Naked)</option>
  <option value="put_sell">Put Vendida (Naked)</option>
  <option disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>
  <option value="bull_call">Bull Call Spread</option>
  <option value="bear_put">Bear Put Spread</option>
</select>

<div class="alert">
âš ï¸ Venda de opÃ§Ãµes envolve risco elevado e exigÃªncia de margem.  
Este simulador Ã© educacional.
</div>

<div class="note">
ğŸ“Œ Compare com o grÃ¡fico abaixo antes de analisar.  
O modelo nÃ£o substitui leitura de contexto.
</div>

<button onclick="analisar()">ğŸ“ˆ Analisar OperaÃ§Ã£o</button>

<div id="resultado" class="section"></div>

<div class="section">
<h2>ğŸ“‰ Payoff (simplificado)</h2>
<canvas id="payoff"></canvas>
</div>

<div class="section">
<h2>ğŸ“Š GrÃ¡fico do Ativo</h2>
<iframe id="tv" width="100%" height="420"></iframe>
</div>

</div>

<script>
// ==== FunÃ§Ãµes matemÃ¡ticas ====
function erf(x){
 const a1=0.254829592,a2=-0.284496736,a3=1.421413741,a4=-1.453152027,a5=1.061405429,p=0.3275911;
 const sign=x<0?-1:1; x=Math.abs(x);
 const t=1/(1+p*x);
 const y=1-((((a5*t+a4)*t+a3)*t+a2)*t+a1)*t*Math.exp(-x*x);
 return sign*y;
}
function N(x){ return 0.5*(1+erf(x/Math.sqrt(2))); }

function analisar(){
 const S=+S.value, K=+K.value, T=+T.value/365, Ïƒ=+vol.value/100;
 const r=0.05, estrutura=estrutura_el.value;

 const d1=(Math.log(S/K)+(r+0.5*Ïƒ*Ïƒ)*T)/(Ïƒ*Math.sqrt(T));
 const d2=d1-Ïƒ*Math.sqrt(T);

 let preco=S*N(d1)-K*Math.exp(-r*T)*N(d2);
 let delta=N(d1);
 let pop=(1-delta)*100;

 let perfil="Iniciante", risco="Limitado", tag="green", texto="";

 if(estrutura==="put_buy"){
   preco=K*Math.exp(-r*T)*N(-d2)-S*N(-d1);
   delta=N(d1)-1;
   pop=Math.abs(delta)*100;
   texto="Direcional de baixa com risco limitado ao prÃªmio.";
 }
 if(estrutura.includes("sell")){
   perfil="AvanÃ§ado"; risco="Elevado"; tag="red";
   texto="Venda de opÃ§Ã£o sem proteÃ§Ã£o. Exige margem.";
   pop=Math.abs(delta)*100;
 }
 if(estrutura.includes("spread")){
   perfil="IntermediÃ¡rio"; risco="Limitado"; tag="yellow";
   texto="Spread vertical com risco e retorno limitados.";
   pop=60;
 }

 resultado.innerHTML=`
 <h2>ğŸ“ Black-Scholes & Risco</h2>
 <p><b>PreÃ§o TeÃ³rico:</b> $${preco.toFixed(2)}</p>
 <p><b>Delta:</b> ${delta.toFixed(2)}</p>
 <p><b>POP (educacional):</b> ${pop.toFixed(0)}%</p>
 <p><b>Perfil:</b> <span class="tag ${tag}">${perfil}</span></p>
 <p><b>Risco:</b> ${risco}</p>
 <p>${texto}</p>
 `;

 tv.src=`https://s.tradingview.com/widgetembed/?symbol=${ativo.value}&interval=60&theme=dark`;
 desenharPayoff(S,K);
}

function desenharPayoff(S,K){
 const c=payoff,ctx=c.getContext("2d");
 c.width=c.offsetWidth; c.height=260;
 ctx.clearRect(0,0,c.width,c.height);
 ctx.beginPath(); ctx.strokeStyle="#22c55e"; ctx.lineWidth=3;
 for(let x=0;x<=c.width;x++){
   const p=S-30+(x/c.width)*60;
   const pf=Math.max(p-K,0);
   const y=c.height-pf*4-40;
   if(x===0)ctx.moveTo(x,y); else ctx.lineTo(x,y);
 }
 ctx.stroke();
}

const estrutura_el=document.getElementById("estrutura");
</script>

</body>
</html>

