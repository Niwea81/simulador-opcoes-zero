<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Simulador Educacional de Op√ß√µes</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #020617, #020024);
  color: #e5e7eb;
}

.container {
  max-width: 900px;
  margin: 40px auto;
  background: #020617;
  padding: 30px;
  border-radius: 14px;
  box-shadow: 0 0 25px rgba(0,0,0,.6);
}

h1, h2 {
  text-align: center;
  color: #facc15;
}

label {
  display: block;
  margin-top: 15px;
  font-weight: bold;
}

select, input {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  border-radius: 6px;
  border: none;
  font-size: 16px;
}

button {
  margin-top: 25px;
  width: 100%;
  padding: 14px;
  font-size: 18px;
  background: #2563eb;
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
}

.section {
  margin-top: 35px;
  padding: 20px;
  background: #020024;
  border-radius: 12px;
}

canvas {
  width: 100%;
  height: 280px;
  background: #020617;
  border-radius: 10px;
}

.alerta {
  margin-top: 20px;
  color: #f87171;
  font-weight: bold;
  text-align: center;
}
</style>
</head>

<body>

<div class="container">
<h1>üìä Simulador Educacional de Op√ß√µes</h1>

<label>Ativo</label>
<select id="ativo">
  <option value="SPY">SPY</option>
  <option value="SPX">SPX</option>
  <option value="QQQ">QQQ</option>
  <option value="AAPL">AAPL</option>
</select>

<label>Tend√™ncia do Mercado</label>
<select id="tendencia">
  <option value="alta">Alta</option>
  <option value="lateral">Lateral</option>
  <option value="baixa">Baixa</option>
</select>

<label>Volatilidade</label>
<select id="vol">
  <option value="baixa">Baixa</option>
  <option value="media">M√©dia</option>
  <option value="alta">Alta</option>
</select>

<label>Dias at√© o vencimento (DTE)</label>
<input type="number" id="dte" value="7">

<label>Pre√ßo atual do ativo</label>
<input type="number" id="preco" value="100">

<button onclick="analisar()">Analisar Cen√°rio</button>

<!-- RESULTADO EDUCACIONAL -->
<div id="resultado" class="section"></div>

<!-- PAYOFF -->
<div class="section">
  <h2>üìà Payoff Educacional</h2>
  <canvas id="payoff"></canvas>
</div>

<!-- TRADINGVIEW (ISOLADO) -->
<div class="section">
  <h2>üìâ Gr√°fico do Ativo</h2>
  <iframe id="tv"
    width="100%"
    height="400"
    frameborder="0"
    allowfullscreen>
  </iframe>
</div>

<p class="alerta">
‚ö†Ô∏è Ferramenta educacional. N√£o √© recomenda√ß√£o de investimento.
</p>
</div>

<script>
function analisar() {

  const ativo = document.getElementById("ativo").value;
  const tendencia = document.getElementById("tendencia").value;
  const vol = document.getElementById("vol").value;
  const preco = Number(document.getElementById("preco").value);

  let estrutura = "";
  let strikes = "";
  let prob = "";
  let aula = "";
  let direcao = 0;

  if (tendencia === "alta" && vol !== "alta") {
    estrutura = "Put Credit Spread";
    strikes = `Venda PUT entre ${Math.round(preco*0.95)} e ${Math.round(preco*0.93)}`;
    prob = "65% a 75%";
    aula = "Tend√™ncia de alta + volatilidade controlada favorecem estruturas de cr√©dito na PUT.";
    direcao = -1;
  }
  else if (tendencia === "baixa" && vol !== "alta") {
    estrutura = "Call Credit Spread";
    strikes = `Venda CALL entre ${Math.round(preco*1.05)} e ${Math.round(preco*1.07)}`;
    prob = "65% a 75%";
    aula = "Tend√™ncia de baixa favorece venda de CALL fora do pre√ßo.";
    direcao = 1;
  }
  else {
    estrutura = "Nenhuma estrutura recomendada";
    strikes = "-";
    prob = "Baixa";
    aula = "Cen√°rio inst√°vel. A melhor decis√£o educacional √© n√£o operar.";
    direcao = 0;
  }

  document.getElementById("resultado").innerHTML = `
    <h2>üß† Aula Guiada</h2>
    <p><b>Ativo:</b> ${ativo}</p>
    <p><b>Estrutura:</b> ${estrutura}</p>
    <p><b>Regi√£o de Strikes:</b> ${strikes}</p>
    <p><b>Probabilidade estimada:</b> ${prob}</p>
    <p>${aula}</p>
  `;

  desenharPayoff(preco, direcao);

  document.getElementById("tv").src =
    `https://s.tradingview.com/widgetembed/?symbol=${ativo}&interval=60&theme=dark`;
}

function desenharPayoff(preco, direcao) {
  const c = document.getElementById("payoff");
  const ctx = c.getContext("2d");
  c.width = c.offsetWidth;
  c.height = 280;
  ctx.clearRect(0,0,c.width,c.height);

  ctx.strokeStyle = "#22c55e";
  ctx.lineWidth = 3;
  ctx.beginPath();

  for (let x = 0; x <= c.width; x++) {
    const p = preco - 20 + (x / c.width) * 40;
    let y = c.height/2;

    if (direcao === -1) y -= (p - preco) * 3;
    if (direcao === 1) y += (p - preco) * 3;

    if (x === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  }

  ctx.stroke();
}
</script>

</body>
</html>
