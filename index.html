<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Simulador Educacional de Op√ß√µes</title>

<style>
body{
  background:#020617;
  color:#e5e7eb;
  font-family:Arial, sans-serif;
}
.container{
  max-width:1200px;
  margin:30px auto;
  background:#020024;
  padding:30px;
  border-radius:20px;
}
h1,h2,h3{color:#facc15;text-align:center}
label{display:block;margin-top:14px;font-weight:bold}
input,select{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:none;
}
button{
  margin-top:25px;
  width:100%;
  padding:16px;
  font-size:18px;
  background:#2563eb;
  color:white;
  border:none;
  border-radius:12px;
  cursor:pointer;
}
.section{
  margin-top:30px;
  background:#020617;
  padding:20px;
  border-radius:16px;
}
.guided{
  background:#020024;
  border-left:4px solid #22c55e;
  padding:18px;
  margin-top:20px;
  line-height:1.6;
}
.alert{
  background:#450a0a;
  border-left:4px solid #ef4444;
  padding:14px;
  margin-top:14px;
}
.note{
  background:#020024;
  border-left:4px solid #facc15;
  padding:14px;
  margin-top:14px;
}
canvas{
  width:100%;
  height:360px;
  background:#020024;
  border-radius:12px;
}
.legend{margin-top:10px;font-size:14px}
iframe{width:100%;height:420px;border:none;border-radius:14px}
</style>
</head>

<body>
<div class="container">

<h1>üìä Simulador Educacional de Op√ß√µes</h1>

<label>Ativo</label>
<select id="ativo" onchange="atualizarGrafico()">
  <option>SPY</option><option>SPX</option><option>XSP</option><option>QQQ</option>
  <option>AAPL</option><option>MSFT</option><option>AMZN</option><option>GOOGL</option>
  <option>META</option><option>NVDA</option><option>TSLA</option>
</select>

<div class="section">
<h2>üìà Gr√°fico de Contexto</h2>
<iframe id="tv"></iframe>
<p style="color:#94a3b8">Compare com o gr√°fico antes de decidir.</p>
</div>

<label>Pre√ßo atual do ativo (S)</label>
<input id="S" type="number" value="100">
<p style="font-size:13px;color:#94a3b8">
Pre√ßo do ativo ‚â† Strike da op√ß√£o
</p>

<label>Volatilidade Impl√≠cita (%)</label>
<input id="iv" type="number" value="20">

<label>Dias at√© o Vencimento (DTE)</label>
<input id="dte" type="number" value="7">

<label>Estrutura</label>
<select id="estrutura" onchange="ajustarEstrutura()">
  <option value="callLong">Call Comprada</option>
  <option value="putLong">Put Comprada</option>
  <option value="callShort">Call Vendida</option>
  <option value="putShort">Put Vendida</option>
  <option value="bull">Bull Call Spread</option>
  <option value="bear">Bear Put Spread</option>
</select>

<div id="riscoEstrutura"></div>

<div id="single">
<label>Strike da Op√ß√£o</label>
<input id="K" type="number" value="100">
</div>

<div id="spread" style="display:none">
<label>Strike Comprado</label>
<input id="Kbuy" type="number" value="95">
<label>Strike Vendido</label>
<input id="Ksell" type="number" value="105">
</div>

<button onclick="analisar()">üìä Analisar</button>

<div class="section">
<h2>üìâ Payoff no Vencimento</h2>
<canvas id="payoff"></canvas>
<div class="legend">
üü¢ Lucro &nbsp; üî¥ Preju√≠zo &nbsp; üü° Break-even
</div>
</div>

<div id="resultado" class="section"></div>
<div id="aula" class="guided"></div>

</div>

<script>
function atualizarGrafico(){
  tv.src=`https://s.tradingview.com/widgetembed/?symbol=${ativo.value}&interval=15&theme=dark`;
}
atualizarGrafico();

function ajustarEstrutura(){
  const e=estrutura.value;
  single.style.display=(e!=="bull"&&e!=="bear")?"block":"none";
  spread.style.display=(e==="bull"||e==="bear")?"block":"none";

  let txt="";
  if(e==="callShort"){
    txt="‚ö†Ô∏è Call vendida: risco teoricamente ilimitado. Exige margem. N√£o √© coberta sem ativo.";
  }
  if(e==="putShort"){
    txt="‚ö†Ô∏è Put vendida: risco elevado. Exige capital ou margem para compra do ativo.";
  }
  if(e==="callLong"||e==="putLong"){
    txt="‚úîÔ∏è Risco limitado ao pr√™mio pago. N√£o exige margem.";
  }
  if(e==="bull"||e==="bear"){
    txt="‚úîÔ∏è Spread vertical: risco e ganho limitados. Estrutura educacional.";
  }

  riscoEstrutura.innerHTML=`<div class="note">${txt}</div>`;
}

function payoffValor(price,est,strikes){
  switch(est){
    case "callLong": return Math.max(price-strikes[0],0);
    case "putLong": return Math.max(strikes[0]-price,0);
    case "callShort": return -Math.max(price-strikes[0],0);
    case "putShort": return -Math.max(strikes[0]-price,0);
    case "bull": return Math.max(price-strikes[0],0)-Math.max(price-strikes[1],0);
    case "bear": return Math.max(strikes[1]-price,0)-Math.max(strikes[0]-price,0);
  }
}

function analisar(){
  const S0=+S.value;
  const est=estrutura.value;
  let strikes=(est==="bull"||est==="bear")?[+Kbuy.value,+Ksell.value]:[+K.value];
  desenharPayoff(S0,est,strikes);
  mostrarResultados();
}

function desenharPayoff(S0,est,strikes){
  const c=payoff,ctx=c.getContext("2d");
  c.width=c.offsetWidth;c.height=360;
  ctx.clearRect(0,0,c.width,c.height);

  const min=S0*0.7,max=S0*1.3;
  const zeroY=c.height/2;

  ctx.strokeStyle="#facc15";
  ctx.beginPath();ctx.moveTo(0,zeroY);ctx.lineTo(c.width,zeroY);ctx.stroke();

  for(let x=0;x<=c.width;x++){
    const price=min+(x/c.width)*(max-min);
    const p=payoffValor(price,est,strikes);
    const y=zeroY-p*5;

    ctx.strokeStyle=p>=0?"#22c55e":"#ef4444";
    ctx.beginPath();
    ctx.moveTo(x,y);
    ctx.lineTo(x+1,y);
    ctx.stroke();
  }
}

function mostrarResultados(){
  resultado.innerHTML=`
  <h2>üìê Vari√°veis da Opera√ß√£o</h2>
  <p><b>IV:</b> ${iv.value}%</p>
  <p><b>DTE:</b> ${dte.value} dias</p>
  <p><b>POP:</b> educacional</p>
  <p><b>Risco:</b> conforme estrutura escolhida</p>
  `;

  aula.innerHTML=`
  <h3>üéì Aula Guiada</h3>
  <p>Pre√ßo do ativo e strike s√£o coisas diferentes.</p>
  <p>Op√ß√µes vendidas exigem controle de risco e margem.</p>
  <p>Spreads s√£o ideais para estudo e iniciantes.</p>
  <p>Gest√£o sempre vem antes da estrat√©gia.</p>
  `;
}

ajustarEstrutura();
</script>

</body>
</html>


