<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Simulador Educacional de OpÃ§Ãµes</title>

<style>
body{
  background:#020617;
  color:#e5e7eb;
  font-family:Arial;
}
.container{
  max-width:1100px;
  margin:40px auto;
  background:#020024;
  padding:30px;
  border-radius:18px;
}
h1,h2{color:#facc15;text-align:center}
label{display:block;margin-top:14px;font-weight:bold}
input,select{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:6px;
  border:none;
}
button{
  margin-top:25px;
  width:100%;
  padding:16px;
  font-size:18px;
  background:#2563eb;
  color:#fff;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
.section{
  margin-top:30px;
  background:#020617;
  padding:20px;
  border-radius:14px;
}
.note{
  background:#020024;
  border-left:4px solid #facc15;
  padding:12px;
  margin-top:12px;
}
canvas{
  width:100%;
  height:280px;
  background:#020024;
  border-radius:10px;
}
.tag{padding:6px 12px;border-radius:8px;font-weight:bold}
.green{background:#22c55e;color:#000}
.yellow{background:#facc15;color:#000}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ“Š Simulador Educacional de OpÃ§Ãµes</h1>

<label>Ativo</label>
<select id="ativo">
<option>SPY</option><option>SPX</option><option>XSP</option><option>QQQ</option>
<option>AAPL</option><option>MSFT</option><option>NVDA</option>
<option>AMZN</option><option>GOOGL</option><option>META</option><option>TSLA</option>
</select>

<label>PreÃ§o Atual do Ativo</label>
<input id="S" type="number" value="100">

<label>Estrutura</label>
<select id="estrutura" onchange="ajustarFormulario()">
<option value="call">Call Comprada</option>
<option value="put">Put Comprada</option>
<option value="bull">Bull Call Spread</option>
<option value="bear">Bear Put Spread</option>
</select>

<div id="singleStrike">
  <label>Strike</label>
  <input id="K" type="number" value="105">
</div>

<div id="spreadStrikes" style="display:none">
  <label>Strike Comprado</label>
  <input id="Kbuy" type="number" value="100">

  <label>Strike Vendido</label>
  <input id="Ksell" type="number" value="110">
</div>

<label>Dias atÃ© o Vencimento</label>
<input id="T" type="number" value="7">

<label>Volatilidade (%)</label>
<input id="vol" type="number" value="20">

<div class="note">
ğŸ“Œ Compare sempre com o grÃ¡fico antes de decidir.
</div>

<button onclick="analisar()">ğŸ“ˆ Analisar</button>

<div id="resultado" class="section"></div>

<div class="section">
<h2>ğŸ“‰ Payoff da OperaÃ§Ã£o</h2>
<canvas id="payoff"></canvas>
<div id="payoffMsg"></div>
</div>

<div class="section">
<h2>ğŸ“Š GrÃ¡fico do Ativo</h2>
<iframe id="tv" width="100%" height="420"></iframe>
</div>

</div>

<script>
function ajustarFormulario(){
  const e=document.getElementById("estrutura").value;
  document.getElementById("singleStrike").style.display =
    (e==="call"||e==="put")?"block":"none";
  document.getElementById("spreadStrikes").style.display =
    (e==="bull"||e==="bear")?"block":"none";
}

function analisar(){
  const S=+S.value;
  const estrutura=estrutura.value;

  let strikes=[];
  if(estrutura==="call"||estrutura==="put"){
    strikes=[+K.value];
  }else{
    strikes=[+Kbuy.value,+Ksell.value];
  }

  desenharPayoff(S,estrutura,strikes);

  document.getElementById("tv").src=
   `https://s.tradingview.com/widgetembed/?symbol=${ativo.value}&interval=60&theme=dark`;

  document.getElementById("resultado").innerHTML=`
  <h2>ğŸ“ Estrutura Analisada</h2>
  <p><b>Estrutura:</b> ${estrutura.toUpperCase()}</p>
  <p><b>Strikes:</b> ${strikes.join(" / ")}</p>
  <p><span class="tag green">Educacional</span></p>
  `;
}

function desenharPayoff(S,estrutura,strikes){
  const c=document.getElementById("payoff");
  const ctx=c.getContext("2d");
  c.width=c.offsetWidth;
  c.height=280;
  ctx.clearRect(0,0,c.width,c.height);

  const min=S*0.7,max=S*1.3;
  const scaleX=c.width/(max-min);
  const scaleY=4;

  ctx.beginPath();
  ctx.strokeStyle="#22c55e";
  ctx.lineWidth=3;

  for(let x=0;x<=c.width;x++){
    const price=min+(x/c.width)*(max-min);
    let payoff=0;

    if(estrutura==="call"){
      payoff=Math.max(price-strikes[0],0);
    }
    if(estrutura==="put"){
      payoff=Math.max(strikes[0]-price,0);
    }
    if(estrutura==="bull"){
      payoff=Math.max(price-strikes[0],0)-Math.max(price-strikes[1],0);
    }
    if(estrutura==="bear"){
      payoff=Math.max(strikes[1]-price,0)-Math.max(strikes[0]-price,0);
    }

    const y=c.height-payoff*scaleY-40;
    if(x===0)ctx.moveTo(x,y); else ctx.lineTo(x,y);
  }
  ctx.stroke();

  document.getElementById("payoffMsg").innerHTML=`
  <p>ğŸ”´ Abaixo do breakeven: comeÃ§a a dor</p>
  <p>ğŸŸ¡ RegiÃ£o neutra: atenÃ§Ã£o</p>
  <p>ğŸŸ¢ RegiÃ£o favorÃ¡vel: vocÃª fica mais tranquilo</p>
  `;
}
</script>

</body>
</html>

